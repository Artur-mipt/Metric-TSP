\documentclass[a4paper,12pt]{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian,english]{babel}
\usepackage{amsmath,amssymb}
\usepackage{indentfirst}
\usepackage{hyperref}
\usepackage{mathtext}
\usepackage{dsfont}
\usepackage{fixmath}
\usepackage{amsmath}
\usepackage{upgreek}
\usepackage{graphicx}
\usepackage{wrapfig}

\graphicspath{ {./images/} }

\title{Задача коммивояжёра}
\author{Артур Мутолапов 798}
\date{9 ноября 2019}

\begin{document}
\maketitle

\section{Постановка задачи}

\subsection{Стандартная задача коммивояжёра}
Дано: граф $ G = (V, E) $ и веса на рёбрах $ w: V \rightarrow \mathscr{R}_{+}$

Найти: гамильтонов цикл минимального веса

\subsection{Метрическая задача коммивояжёра}

Дано: полный граф $ G = (V, E) $ и веса на рёбрах $ w: V \rightarrow \mathscr{R}_{+}$, т.ч. $\forall \: x, y, z \in V : \: w(x, z) \leq w(x, y) + w(y, z)$ 

Найти: гамильтонов цикл минимального веса

\section{Т. Для стандартной задачи коммивояжёра не существует константных алгоритмов приближения, если P != NP}

Формально: 
$$ P \neq NP => \forall \rho \geq 1 \: \neg{\exists} \text{ полиномально вычислимого алгоритма с аппроксимацией } \rho
$$

Доказательство:

От прот. Зафиксируем $\rho$, для которого существет алгоритм с аппроксимацией $\rho$.

1) Пусть $ G = (V, E)$ - произвольный граф. Построим полный граф $ G' = (V, E')$ и зададим на нём веса рёбер след. образом:

$$ c(u, v) = 1, \: (u,v) \in E $$
$$ c(u, v) = \rho |V| + 1, \: (u,v) \notin E $$

2) Утв. В $G$ есть гамильтонов цикл <=> в $G'$ есть гамильтонов цикл веса $|V|$.

2.1) Док-во =>: возьмем гам. цикл в $G$, тогда он присутствует в том же виде в $G'$, при этом все ребра имеют вес 1, значит весь цикл имеет вес $|V|$.

2.2) Док-во <=: гамильтонов цикл содержит |V| рёбер по определению. Так как вес цикла равен $|V|$ и все рёбра в $G'$ имеют вес $\geq 1$, то каждое ребро $(u, v)$ в этом цикле имеет вес 1, а значит $(u ,v) \in E$, а значит все такие ребра образуют гамильтонов цикл в $G$.

3) Если в $G$ нет гам. цикла, то по (2) самый легкий гам. цикл в $G'$ имеет вес $\geq (\rho|V| + 1) + (|V| - 1) > \rho|V|$. Отсюда, если в $G'$ существует гам. цикл веса $ <= \rho|V|$, то в $G$ есть гам. цикл.

4) Возьмём алгоритм с аппроксимацией $\rho$. Пусть $ans$ - результат работы этого алгоритма на графе $G$. Тогда возможны два случая.

4.1) $ans / \rho > |V|$ => в $G'$ нет гам. цикла веса  $|V|$ => по (2) в $G$ нет гам. цикла.

4.2) $ans / \rho \leq |V|$ => $ans \leq \rho|V|$ => по (3) в $G$ есть гам. цикл.

5) Таким образом, в (4) мы за полиномиальное время проверяем, есть ли гам. цикл в графе $G$, но задача $HAMCYCLE \in NP$ => $P = NP$ - противоречие с условием.

ч.т.д.

\section{Алгоритм, дающий 2-приближение}

\subsection{Описание}

1) С помощью алгоритма Крускала найдем минимальное остовное дерево.

2) Запустим по дереву обход в глубину, каждую вновь посещенную вершину записываем в массив, тем самым запоминая порядок обхода. Тогда внутренние вершины дерева будут встречаться в массиве несколько раз, листья - по одному.

3) Оставим в порядке обхода лишь по одному экземпляру каждой вершины, причем оставляем тот экземпляр, который раньше всех встречается в массиве. Добавим в конец полученного пути стартовую вершину - получим гамильтонов цикл.

\subsection{Точность аппроксимации}

Т. Полученный гамильтонов цикл имеет вес не более чем в 2 раза больший, чем вес решения метрической задачи коммивояжёра на этом графе.

Доказательство:

1) Пусть $M$ - вес минимального остовного дерева, $OPT$ - вес минимального гам. цикла., $T_2$ - вес цикла, полученного на шаге (2) алгоритма, $T_3$ - вес цикла, полученного на шаге (3) алгоритма.

2) $ M \leq OPT$, т.к. пройдя по каждому ребру остовного дерева по одному разу, будут посещены все вершины, притом вес обхода будет минимален по определению, т.к. остовное дерево минимально.

3) Утв. $T_3 \leq T_2$. Доказательство: пусть последовательность ребер $(e_i, .., e_j)$ в гам. цикле веса $T_2$ заменилась ребром $e$ в гам. цикле веса $T_3$. Тогда по нер-ву треугольника: $w_e \leq w_{e_i} + .. + w_{e_j}$ ч.т.д.

4) $T_2 = 2M$, т.к. каждое ребро дерева посещается ровно два раза.

5) Итого $T_3 \leq T_2 = 2M \leq 2OPT$.

ч.т.д.

\section{Алгоритм, дающий 1.5-приближение}

\subsection{Формулировки}

Лемма о рукопожатиях. Любой конечный неориентированный граф имеет чётное число вершин нечетных степеней.

Опр. Паросочетание - набор попарно несмежных ребер.

Опр. Совершенное паросочетание - паросочетание, в котором участвуют все вершины графа. То есть любая вершина графа инцидентна ровно одному ребра, входящему в паросочетание.

Опр. Порождённый подграф графа - это другой граф, образованный из подмножества вершин графа вместе со всеми ребрами, соединяющими пары вершин из этого подмножества.

Опр. Эйлеров цикл - это цикл, проходящий по всем ребрам графа 

\subsection{Описание}
Пусть $G = (V, E)$ - полный граф, $w: E \rightarrow \mathscr{R}_{+}$ - веса его ребер. Также $\forall x, y, z \in V: w(x, y) \leq w(x, z) + w(z, y)$. 

1) С помощью алгоритма Крускала находим минимальное остовное дерево $T$ графа $G$.

2) Пусть $O$ - набор вершин с нечетными степенями в $T$. По лемме о рукопожатиях: $|O| = 2k + 1$ для некоторого $k \in \mathscr{N}$.

3) Находим совершенное паросочетание $M$ минимального веса в порождённом подграфе, заданном вершинами из $O$.

4) Комбинируем ребра $M$ и $T$ - получаем мультиграф $H$, в котором каждая вершина имеет четную степень.

5) Находим эйлеров цикл в $H$.

6) Преобразуем найденный эйлеров цикл в гамильтонов, пропуская повторяющиеся вершины.

\subsection{Точность аппроксимации}

Т. Полученный гамильтонов цикл имеет вес не более чем в 1.5 раза больший, чем вес решения метрической задачи коммивояжёра на этом графе.

Доказательство: 

1) Пусть $C$ - оптимальный обход в задаче коммивояжёра. Тогда $w(T) \leq w(C)$ (см. 3.2. пункт (2) доказательства).

2) Нумеруем вершины $O$ в циклическом порядке по $C$ и делим  $C$ на два множества путей — одно имеет нечётные номера первых вершины в циклическом порядке, а второе имеет чётные номера. Каждый набор путей соответствует совершенному паросочетанию множества O, которое сочетает в пару две конечные точки каждого пути, а вес этого сочетания не превосходит веса путей. Поскольку эти два множества путей разбивают рёбра C, одно из этих двух множеств имеет максимум половину веса C, и благодаря неравенству треугольника их соответствующее паросочетание имеет вес, который также не менее половины веса C. Совершенное паросочетание минимального веса не может иметь больший вес, так что $w(M) \leq w(C)/2$. Сложение весов $T$ и $M$ даёт вес эйлерова цикла, который не превосходит $3w(C)/2$. Благодаря неравенству треугольника сокращение не увеличивает вес, так что вес результата также не превосходит $3w(C)/2$.

\end{document}
